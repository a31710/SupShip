<!-- <ng-container *ngIf="loaderService.isLoading | async">
  <div class="lds-ripple"><div></div><div></div></div>
 </ng-container> -->

<div class="mt-4 body">

  <div class="report-header">
    <h3 class="text-header text-primary">Chi nhánh</h3>
    <div class="text-desc ">{{reportData?.totalDept}}</div>
  </div>
  <div class="report-header">
    <h3 class="text-header text-primary">Bưu cục</h3>
    <div class="text-desc ">{{reportData?.totalPost}}</div>
  </div>
  <div class="report-header">
    <h3 class="text-header text-primary">Nhân viên</h3>
    <div class="text-desc ">{{reportData?.totalCountEmp}}</div>
  </div>
  <div class="report-header">
    <h3 class="text-header text-primary">Kế hoạch</h3>
    <div class="text-desc ">{{reportData?.totalAssigns}}</div>
  </div>
  <div class="report-header">
    <h3 class="text-header text-primary">Đã tiếp xúc</h3>
    <div class="text-desc ">{{reportData?.totalAssigned}}</div>
  </div>
  <div class="report-header">
    <h3 class="text-header text-primary">Thành công</h3>
    <div class="text-desc text-success">{{reportData?.totalSuccesses}}</div>
  </div>
  <div class="report-header">
    <h3 class="text-header text-primary">Đang tiếp xúc</h3>
    <div class="text-desc text-warning">{{reportData?.totalContacting}}</div>
  </div>
  <div class="report-header">
    <h3 class="text-header text-primary">Thất bại</h3>
    <div class="text-desc text-danger">{{reportData?.totalFails}}</div>
  </div>
  <div class="report-header">
    <h3 class="text-header text-primary">TL tiếp xúc</h3>
    <div class="text-desc ">{{reportData?.totalAssigned}}%</div>
  </div>
  <div class="report-header">
    <h3 class="text-header text-primary">TL hoàn thành KH</h3>
    <div class="text-desc ">{{reportData?.totalAssigned}}%</div>
  </div>



    <div id="myDIV" class="">

        <div id="left" >
          <div  class="button selected" id="left-switcher-default" style="width:200px" id="date-picker-example"  inline="true">
            <ng-select class="custom" [readonly]="dsbDept" placeholder="Chọn chi nhánh"  bindValue="deptCode"
            [(ngModel)]="deptCodeSelect"  [items]="dataDept" bindLabel="deptName"  >
           </ng-select>
          </div>


          <div class="button selected" id="left-switcher-default" style="width:200px">
            <p-calendar [(ngModel)]="fromDate" dateFormat="dd/mm/yy" [showIcon]="true" inputId="icon"></p-calendar>
          </div>


          <div class="button selected" id="left-switcher-default" style="width:200px">
            <p-calendar [(ngModel)]="toDate" dateFormat="dd/mm/yy" [showIcon]="true" inputId="icon"></p-calendar>
        </div>




        <div class="button selected" id="left-switcher-default">
          <button (click)="onSearch()" class="btn btn-sm btn-success "><i class="fas fa-search fa-sm text-white-900 mr-2"></i>Tìm kiếm</button>
        </div>


        </div>


        <div id="right">
          <div class="button selected" id="switcher-default">
            <button (click)="exportExcelTuyen()" class="btn btn-sm btn-info "><i class="fas fa-file-download text-white-900 mr-2"></i>Excel Tuyến</button>
          </div>
          <div class="button" id="switcher-narrow">
            <button (click)="exportExcelCN()" class="btn btn-sm btn-success "><i class="fas fa-file-download text-white-900 mr-2"></i>Excel CN</button>
          </div>
          <div class="button" id="switcher-narrow">
            <button (click)="exportExcelBC()" class="btn btn-sm btn-primary "><i class="fas fa-file-download text-white-900 mr-2"></i>Excel BC</button>
          </div>


      </div>



    </div>












    <table class="table align-middle" style="background-color: white">
      <thead style="background-color: #4e73df; color: white;">
        <tr>
          <th scope="col">Chi nhánh</th>
          <th scope="col">Bưu cục</th>
          <th scope="col">Số lượng nhân viên</th>
          <th scope="col">kế hoạch TXKH</th>
          <th scope="col">SL KH đã tiếp xúc (TC-Đang TX-TB)</th>
          <th scope="col">SL KH chưa tiếp xúc</th>
          <th scope="col">TL hoàn thành</th>
          <th scope="col">SL cá nhân chưa có tx</th>
          <th scope="col">TL tiếp xúc</th>
          <th scope="col">Thao tác</th>

        </tr>
      </thead>
      <tbody>

        <tr *ngFor="let item of pagiData" class="tbhov">
              <td class="text-primary"><a style="cursor: pointer;" (click)="toogleData(item?.deptCode)"><i *ngIf="item?.deptCode" class="fas fa-caret-right mr-2 text-primary"></i> {{item?.deptCode}}</a></td>
              <td class="text-info">{{item?.postCode?item?.postCode:item?.reportMonthlyPostOfficeDtos.length + ' Bưu cục'}}</td>

              <td>
                <ng-container *ngIf="item?.totalEmployees || item?.totalEmployees == 0">
                  {{item?.totalEmployees}}
                </ng-container>
                <ng-container *ngIf="item?.totalCountEmp || item?.totalCountEmp == 0">
                  {{item?.totalCountEmp}}
                </ng-container>
              </td>
              <td>{{item?.totalAssigns}}</td>
              <td>
                <ng-container *ngIf="item?.assigned || item?.assigned == 0">
                  <span class="text-primary">{{item?.assigned}}</span> (<span class="text-success">{{item?.successes}}</span> - <span class="text-warning">{{item?.contacting}}</span> - <span class="text-danger">{{item?.fails}}</span>)
                </ng-container>
                <ng-container *ngIf="item?.totalAssigned || item?.totalAssigned == 0">
                  <span class="text-primary">{{item?.totalAssigned}}</span> (<span class="text-success">{{item?.totalSuccesses}}</span> - <span class="text-warning">{{item?.totalContacting}}</span> - <span class="text-danger">{{item?.totalFails}}</span>)
                </ng-container>

              </td>
              <td class="text-danger">
                <ng-container *ngIf="item?.employeeNotAssigned || item?.employeeNotAssigned == 0">
                  {{item?.employeeNotAssigned}}
                </ng-container>
                <ng-container *ngIf="item?.totalEmployeeNotAssigned || item?.totalEmployeeNotAssigned == 0">
                  {{item?.totalEmployeeNotAssigned}}
                </ng-container>

              </td>
              <td class="text-success">{{item?.tyHT}}%</td>
              <td class="text-warning">{{item?.tyTX}}%</td>
              <td>0%</td>
              <td>

               <ng-container  *ngIf="!item.deptCode">
                <i class="fas fa-eye px-3" (click)="postReport(item?.postCode)" style="cursor: pointer;" ></i>
               </ng-container>
              </td>


        </tr>

      </tbody>
    </table>
    <app-pagination [offset]="offset" [limit]="limit" [size]="size" totalPage="totalPage" (pageChange)="onPageChange($event)"></app-pagination>


</div>
